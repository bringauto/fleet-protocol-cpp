CMAKE_MINIMUM_REQUIRED(VERSION 3.25 FATAL_ERROR)
PROJECT(fleet-protocol C CXX)

SET(MODULE_MAINTAINER_TARGET_NAME fleet_protocol_cxx_helpers)
SET(MODULE_MAINTAINER_ALIAS_NAME  ${PROJECT_NAME}::cxx_helpers)
SET(COMMON_HEADERS_TARGET         fleet-protocol::common_headers)

SET(CMAKE_POSITION_INDEPENDENT_CODE ON)

IF(NOT TARGET ${COMMON_HEADERS_TARGET})
    MESSAGE(FATAL_ERROR "TARGET ${COMMON_HEADERS_TARGET} is not defined!")
ENDIF()

FILE(GLOB_RECURSE source_files source/*)
ADD_LIBRARY(${MODULE_MAINTAINER_TARGET_NAME} STATIC
    ${source_files}
)
TARGET_INCLUDE_DIRECTORIES(${MODULE_MAINTAINER_TARGET_NAME} PUBLIC "include")
TARGET_LINK_LIBRARIES(${MODULE_MAINTAINER_TARGET_NAME} PUBLIC
    ${COMMON_HEADERS_TARGET}
)

ADD_LIBRARY(${MODULE_MAINTAINER_ALIAS_NAME} ALIAS  ${MODULE_MAINTAINER_TARGET_NAME})
